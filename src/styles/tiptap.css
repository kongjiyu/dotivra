/* Reset editor base so headings use root-relative sizing */
.tiptap { 
  font-size: 1rem !important; 
  line-height: 1.5;
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
  pointer-events: auto !important;
}

/* Ensure ProseMirror container allows text selection */
.ProseMirror {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
  pointer-events: auto !important;
}

/* Ensure document-content allows text selection */
.document-content {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
  pointer-events: auto !important;
}

/* Ensure all direct children allow text selection */
.tiptap > *,
.ProseMirror > *,
.document-content > * {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
  pointer-events: auto !important;
}

/* Text selection highlight - consistent across all elements */
.tiptap ::selection {
  background-color: #d1d5db;
  color: inherit;
}

.tiptap ::-moz-selection {
  background-color: #d1d5db;
  color: inherit;
}

/* Ensure selection works across inline formatting elements */
.tiptap strong::selection,
.tiptap em::selection,
.tiptap u::selection,
.tiptap s::selection,
.tiptap code::selection,
.tiptap mark::selection,
.tiptap a::selection {
  background-color: #d1d5db;
  color: inherit;
}

.tiptap strong::-moz-selection,
.tiptap em::-moz-selection,
.tiptap u::-moz-selection,
.tiptap s::-moz-selection,
.tiptap code::-moz-selection,
.tiptap mark::-moz-selection,
.tiptap a::-moz-selection {
  background-color: #d1d5db;
  color: inherit;
}

/* Ensure inline elements allow text selection */
.tiptap strong,
.tiptap em,
.tiptap u,
.tiptap s,
.tiptap mark,
.tiptap a,
.tiptap code {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
}

/* Ensure selection works across block elements (paragraphs and headings) */
.tiptap p::selection,
.tiptap h1::selection,
.tiptap h2::selection,
.tiptap h3::selection,
.tiptap h4::selection,
.tiptap h5::selection,
.tiptap h6::selection,
.tiptap blockquote::selection,
.tiptap li::selection,
.tiptap div::selection,
.tiptap span::selection {
  background-color: #d1d5db;
  color: inherit;
}

.tiptap p::-moz-selection,
.tiptap h1::-moz-selection,
.tiptap h2::-moz-selection,
.tiptap h3::-moz-selection,
.tiptap h4::-moz-selection,
.tiptap h5::-moz-selection,
.tiptap h6::-moz-selection,
.tiptap blockquote::-moz-selection,
.tiptap li::-moz-selection,
.tiptap div::-moz-selection,
.tiptap span::-moz-selection {
  background-color: #d1d5db;
  color: inherit;
}

/* Ensure block elements allow text selection */
.tiptap p,
.tiptap h1,
.tiptap h2,
.tiptap h3,
.tiptap h4,
.tiptap h5,
.tiptap h6,
.tiptap blockquote,
.tiptap li,
.tiptap div,
.tiptap span,
.tiptap ul,
.tiptap ol,
.tiptap table,
.tiptap tr,
.tiptap td,
.tiptap th {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
}

/* Override any Tailwind prose styles that might interfere */
.prose p,
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6,
.prose blockquote,
.prose li,
.prose div,
.prose span {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
}

/* Default paragraph styling - 18px Times New Roman */
.tiptap p {
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  margin: 0.5em 0;
}

.tiptap h1 { font-size: 2rem;    font-weight: 700; line-height: 1.1; margin: 2rem 0 0.75rem; }
.tiptap h2 { font-size: 1.5rem;  font-weight: 600;                 margin: 1.5rem 0 0.5rem;  }
.tiptap h3 { font-size: 1.17rem; font-weight: 600;                 margin: 1.25rem 0 0.5rem; }
.tiptap h4 { font-size: 1rem;    font-weight: 600;                 margin: 1rem 0 0.5rem;    }
.tiptap h5 { font-size: .83rem;  font-weight: 600;                 margin: .75rem 0 0.5rem;  }
.tiptap h6 { font-size: .67rem;  font-weight: 600;                 margin: .5rem  0 0.5rem;  }

/* Blockquote styling with vertical line */
.tiptap blockquote {
  margin: 1.5em 0;
  padding: 0.5em 0 0.5em 1.2em;
  position: relative;
  color: #4B5563; /* Slate gray */
  font-style: normal;
  border: none;
}

/* Inline code styling - kbd-like appearance */
.tiptap code {
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 0.9em;
  background-color: #f3f4f6;
  color: #1f2937;
  padding: 0.2em 0.4em;
  border-radius: 4px;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.05);
  white-space: pre-wrap;
  word-break: break-word;
}

/* Inline code in dark backgrounds */
.tiptap blockquote code {
  background-color: #e5e7eb;
  border-color: #d1d5db;
}

/* Vertical line styling */
.tiptap blockquote::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 4px;
  background-color: #c3cde3; /* Light Cloud Blue vertical line */
  border-radius: 2px;
}

/* Horizontal rule (divider) styling */
.tiptap hr,
.tiptap hr.tiptap-hr {
  border: none;
  border-top: 2px solid #e5e7eb;
  margin: 32px 0;
  cursor: default;
}

.tiptap hr:hover,
.tiptap hr.tiptap-hr:hover {
  border-top-color: #d1d5db;
}

/* Highlight text styling - multicolor support */
.tiptap mark,
.tiptap .tiptap-highlight {
  color: inherit;
  border-radius: 2px;
}

/* Default gray highlight when no color is specified */
.tiptap mark:not([data-color]),
.tiptap .tiptap-highlight:not([data-color]) {
  background-color: #e5e7eb;
}

/* Style for text inside blockquote */
.tiptap blockquote p {
  margin: 0;
}

/* Protect headings and paragraphs inside blockquotes from being overwritten */
.tiptap blockquote h1,
.tiptap blockquote h2,
.tiptap blockquote h3,
.tiptap blockquote h4,
.tiptap blockquote h5,
.tiptap blockquote h6 {
  font-size: inherit !important;
  font-weight: inherit !important;
  margin: 0 !important;
  line-height: inherit !important;
  color: inherit !important;
}

/* Protect headings and paragraphs inside code blocks from overriding code block styling */
.code-block-wrapper h1,
.code-block-wrapper h2,
.code-block-wrapper h3,
.code-block-wrapper h4,
.code-block-wrapper h5,
.code-block-wrapper h6,
.code-block-wrapper p {
  /* Only prevent heading/paragraph styles from overriding, preserve syntax highlighting */
  font-family: inherit !important;
  font-size: inherit !important;
  font-weight: inherit !important;
  margin: 0 !important;
  line-height: inherit !important;
}

/* Controlled indentation support for paragraphs and headings - maximum 21 levels */
/* This prevents content overflow while still providing extensive indentation options */
.tiptap p[data-indent],
.tiptap h1[data-indent],
.tiptap h2[data-indent],
.tiptap h3[data-indent],
.tiptap h4[data-indent],
.tiptap h5[data-indent],
.tiptap h6[data-indent] {
  /* The margin-left is set via inline style attribute from the extension */
  /* Maximum indentation is 21 levels = 42rem = ~336px to prevent overflow */
  transition: margin-left 0.2s ease;
}

/* CSS fallback rules for common indentation levels (1-21) */
/* These provide better performance for the most commonly used levels */
.tiptap p[data-indent="1"], .tiptap h1[data-indent="1"], .tiptap h2[data-indent="1"], .tiptap h3[data-indent="1"], .tiptap h4[data-indent="1"], .tiptap h5[data-indent="1"], .tiptap h6[data-indent="1"] { margin-left: 2rem; }
.tiptap p[data-indent="2"], .tiptap h1[data-indent="2"], .tiptap h2[data-indent="2"], .tiptap h3[data-indent="2"], .tiptap h4[data-indent="2"], .tiptap h5[data-indent="2"], .tiptap h6[data-indent="2"] { margin-left: 4rem; }
.tiptap p[data-indent="3"], .tiptap h1[data-indent="3"], .tiptap h2[data-indent="3"], .tiptap h3[data-indent="3"], .tiptap h4[data-indent="3"], .tiptap h5[data-indent="3"], .tiptap h6[data-indent="3"] { margin-left: 6rem; }
.tiptap p[data-indent="4"], .tiptap h1[data-indent="4"], .tiptap h2[data-indent="4"], .tiptap h3[data-indent="4"], .tiptap h4[data-indent="4"], .tiptap h5[data-indent="4"], .tiptap h6[data-indent="4"] { margin-left: 8rem; }
.tiptap p[data-indent="5"], .tiptap h1[data-indent="5"], .tiptap h2[data-indent="5"], .tiptap h3[data-indent="5"], .tiptap h4[data-indent="5"], .tiptap h5[data-indent="5"], .tiptap h6[data-indent="5"] { margin-left: 10rem; }
.tiptap p[data-indent="6"], .tiptap h1[data-indent="6"], .tiptap h2[data-indent="6"], .tiptap h3[data-indent="6"], .tiptap h4[data-indent="6"], .tiptap h5[data-indent="6"], .tiptap h6[data-indent="6"] { margin-left: 12rem; }
.tiptap p[data-indent="7"], .tiptap h1[data-indent="7"], .tiptap h2[data-indent="7"], .tiptap h3[data-indent="7"], .tiptap h4[data-indent="7"], .tiptap h5[data-indent="7"], .tiptap h6[data-indent="7"] { margin-left: 14rem; }
.tiptap p[data-indent="8"], .tiptap h1[data-indent="8"], .tiptap h2[data-indent="8"], .tiptap h3[data-indent="8"], .tiptap h4[data-indent="8"], .tiptap h5[data-indent="8"], .tiptap h6[data-indent="8"] { margin-left: 16rem; }
.tiptap p[data-indent="9"], .tiptap h1[data-indent="9"], .tiptap h2[data-indent="9"], .tiptap h3[data-indent="9"], .tiptap h4[data-indent="9"], .tiptap h5[data-indent="9"], .tiptap h6[data-indent="9"] { margin-left: 18rem; }
.tiptap p[data-indent="10"], .tiptap h1[data-indent="10"], .tiptap h2[data-indent="10"], .tiptap h3[data-indent="10"], .tiptap h4[data-indent="10"], .tiptap h5[data-indent="10"], .tiptap h6[data-indent="10"] { margin-left: 20rem; }
.tiptap p[data-indent="11"], .tiptap h1[data-indent="11"], .tiptap h2[data-indent="11"], .tiptap h3[data-indent="11"], .tiptap h4[data-indent="11"], .tiptap h5[data-indent="11"], .tiptap h6[data-indent="11"] { margin-left: 22rem; }
.tiptap p[data-indent="12"], .tiptap h1[data-indent="12"], .tiptap h2[data-indent="12"], .tiptap h3[data-indent="12"], .tiptap h4[data-indent="12"], .tiptap h5[data-indent="12"], .tiptap h6[data-indent="12"] { margin-left: 24rem; }
.tiptap p[data-indent="13"], .tiptap h1[data-indent="13"], .tiptap h2[data-indent="13"], .tiptap h3[data-indent="13"], .tiptap h4[data-indent="13"], .tiptap h5[data-indent="13"], .tiptap h6[data-indent="13"] { margin-left: 26rem; }
.tiptap p[data-indent="14"], .tiptap h1[data-indent="14"], .tiptap h2[data-indent="14"], .tiptap h3[data-indent="14"], .tiptap h4[data-indent="14"], .tiptap h5[data-indent="14"], .tiptap h6[data-indent="14"] { margin-left: 28rem; }
.tiptap p[data-indent="15"], .tiptap h1[data-indent="15"], .tiptap h2[data-indent="15"], .tiptap h3[data-indent="15"], .tiptap h4[data-indent="15"], .tiptap h5[data-indent="15"], .tiptap h6[data-indent="15"] { margin-left: 30rem; }
.tiptap p[data-indent="16"], .tiptap h1[data-indent="16"], .tiptap h2[data-indent="16"], .tiptap h3[data-indent="16"], .tiptap h4[data-indent="16"], .tiptap h5[data-indent="16"], .tiptap h6[data-indent="16"] { margin-left: 32rem; }
.tiptap p[data-indent="17"], .tiptap h1[data-indent="17"], .tiptap h2[data-indent="17"], .tiptap h3[data-indent="17"], .tiptap h4[data-indent="17"], .tiptap h5[data-indent="17"], .tiptap h6[data-indent="17"] { margin-left: 34rem; }
.tiptap p[data-indent="18"], .tiptap h1[data-indent="18"], .tiptap h2[data-indent="18"], .tiptap h3[data-indent="18"], .tiptap h4[data-indent="18"], .tiptap h5[data-indent="18"], .tiptap h6[data-indent="18"] { margin-left: 36rem; }
.tiptap p[data-indent="19"], .tiptap h1[data-indent="19"], .tiptap h2[data-indent="19"], .tiptap h3[data-indent="19"], .tiptap h4[data-indent="19"], .tiptap h5[data-indent="19"], .tiptap h6[data-indent="19"] { margin-left: 38rem; }
.tiptap p[data-indent="20"], .tiptap h1[data-indent="20"], .tiptap h2[data-indent="20"], .tiptap h3[data-indent="20"], .tiptap h4[data-indent="20"], .tiptap h5[data-indent="20"], .tiptap h6[data-indent="20"] { margin-left: 40rem; }
.tiptap p[data-indent="21"], .tiptap h1[data-indent="21"], .tiptap h2[data-indent="21"], .tiptap h3[data-indent="21"], .tiptap h4[data-indent="21"], .tiptap h5[data-indent="21"], .tiptap h6[data-indent="21"] { margin-left: 42rem; }

/* Ensure content doesn't overflow the document area by setting a reasonable maximum width */
.tiptap {
  max-width: 100%;
  overflow-x: auto;
}

/* For very deeply indented content, ensure it remains readable */
.tiptap p[data-indent], .tiptap h1[data-indent], .tiptap h2[data-indent], .tiptap h3[data-indent], .tiptap h4[data-indent], .tiptap h5[data-indent], .tiptap h6[data-indent] {
  max-width: calc(100% - var(--indent-margin, 0px));
  word-wrap: break-word;
}

/* Task List Styling */
.tiptap ul[data-type="taskList"] {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

.tiptap ul[data-type="taskList"] li {
  display: flex;
  align-items: center; /* Changed from flex-start to center for better vertical alignment */
  margin: 0.5rem 0;
}

.tiptap ul[data-type="taskList"] li > label {
  flex: 0 0 auto;
  margin-right: 0.5rem;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 1.5rem; /* Match text line height */
}

.tiptap ul[data-type="taskList"] li > div {
  flex: 1 1 auto;
}

.tiptap ul[data-type="taskList"] li[data-checked="true"] > div {
  text-decoration: line-through;
  color: #6b7280;
}

.tiptap ul[data-type="taskList"] input[type="checkbox"] {
  width: 1rem;
  height: 1rem;
  margin: 0;
  cursor: pointer;
  appearance: none;
  background: transparent;
  border: 2px solid #373a3e;
  border-radius: 3px;
  position: relative;
}

.tiptap ul[data-type="taskList"] input[type="checkbox"]:checked {
  border-color: #373a3e;
  background: transparent;
}

.tiptap ul[data-type="taskList"] input[type="checkbox"]:checked::before {
  content: '✓';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #373a3e;
  font-size: 0.75rem;
  font-weight: bold;
}

/* Nested task lists */
.tiptap ul[data-type="taskList"] ul[data-type="taskList"] {
  margin: 0.25rem 0 0.25rem 1.5rem;
}

/* Task list items */
.tiptap li[data-type="taskItem"] {
  display: flex;
  align-items: center; /* Changed from flex-start to center for better vertical alignment */
}

.tiptap li[data-type="taskItem"] > label {
  flex: 0 0 auto;
  margin-right: 0.5rem;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 1.5rem; /* Match text line height */
}

/* Alternative styling using CSS classes if data attributes don't work */
.tiptap .task-list {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

.tiptap .task-item {
  display: flex;
  align-items: center; /* Changed from flex-start to center for better vertical alignment */
  margin: 0.5rem 0;
}

.tiptap .task-item label {
  flex: 0 0 auto;
  margin-right: 0.5rem;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 1.5rem; /* Match text line height */
}

.tiptap .task-item label input[type="checkbox"] {
  width: 1rem;
  height: 1rem;
  margin: 0;
  cursor: pointer;
  appearance: none;
  background: transparent;
  border: 2px solid #373a3e;
  border-radius: 3px;
  position: relative;
}

.tiptap .task-item label input[type="checkbox"]:checked {
  border-color: #373a3e;
  background: transparent;
}

.tiptap .task-item label input[type="checkbox"]:checked::before {
  content: '✓';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #373a3e;
  font-size: 0.75rem;
  font-weight: bold;
}

/* Styling for completed tasks */
.tiptap .task-item[data-checked="true"] p,
.tiptap .task-item[data-checked="true"] div {
  text-decoration: line-through;
  color: #6b7280;
}

/* Link Styling with Black & White Theme */
.tiptap a {
  color: #000000;
  text-decoration: underline;
  text-decoration-color: #666666;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
  text-underline-offset: 2px;
}

.tiptap a:hover {
  color: #333333;
  text-decoration-color: #000000;
}

/* Add a subtle tooltip hint for Ctrl/Cmd+Click on links */
.tiptap a::after {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background-color: rgba(0, 0, 0, 0.9);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
  margin-bottom: 4px;
  z-index: 1000;
}

.tiptap a:hover::after {
  opacity: 1;
  transition-delay: 0.5s;
}

/* Disable all other link hover tooltips */
.tiptap a:hover::before {
  display: none !important;
}

/* Disable TipTap default link tooltip */
.tiptap a[data-type="link"]:hover::before {
  display: none !important;
}

/* Link styling when editing */
.tiptap a[contenteditable="false"] {
  pointer-events: auto;
}

/* Link insertion tooltip styles */
.link-tooltip {
  position: absolute;
  background: #ffffff;
  border: 2px solid #000000;
  border-radius: 8px;
  padding: 1rem;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
  z-index: 2000;
  min-width: 300px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.link-tooltip h3 {
  margin: 0 0 0.5rem 0;
  font-size: 0.875rem;
  font-weight: 600;
  color: #000000;
}

.link-tooltip input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #000000;
  border-radius: 4px;
  margin-bottom: 0.75rem;
  font-size: 0.875rem;
  background: #ffffff;
  color: #000000;
}

.link-tooltip input:focus {
  outline: none;
  border-color: #000000;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
}

.link-tooltip input::placeholder {
  color: #666666;
}

.link-tooltip .button-group {
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
}

.link-tooltip button {
  padding: 0.5rem 1rem;
  border: 1px solid #000000;
  border-radius: 4px;
  background: #ffffff;
  color: #000000;
  cursor: pointer;
  font-size: 0.875rem;
  transition: all 0.2s ease;
}

.link-tooltip button:hover {
  background: #000000;
  color: #ffffff;
}

.link-tooltip button.primary {
  background: #000000;
  color: #ffffff;
}

.link-tooltip button.primary:hover {
  background: #333333;
}

.link-tooltip button.delete {
  background: #ffffff;
  color: #dc2626;
  border-color: #dc2626;
}

.link-tooltip button.delete:hover {
  background: #dc2626;
  color: #ffffff;
}

/* Link Preview Styles */
.link-preview {
  max-width: 400px;
  background: #ffffff;
  border: 1px solid #e0e0e0;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
  overflow: hidden;
  font-family: system-ui, -apple-system, sans-serif;
}

.link-preview-content {
  padding: 16px;
}

.link-preview-loading {
  display: flex;
  align-items: center;
  gap: 12px;
  color: #666666;
  font-size: 14px;
}

.loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid #e0e0e0;
  border-top: 2px solid #000000;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.link-preview-error {
  color: #dc2626;
  font-size: 14px;
}

.link-preview-data {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.link-preview-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.link-preview-favicon {
  width: 16px;
  height: 16px;
  border-radius: 3px;
}

.link-preview-title {
  font-weight: 600;
  color: #1a1a1a;
  font-size: 14px;
  flex: 1;
}

.link-preview-description {
  color: #666666;
  font-size: 13px;
  line-height: 1.4;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  line-clamp: 2;
  -webkit-box-orient: vertical;
}

.link-preview-url {
  color: #999999;
  font-size: 12px;
  font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
  word-break: break-all;
  background: #f8f8f8;
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid #e8e8e8;
}

/* CodeBlock Component Styling */
.code-block-wrapper {
  margin: 1.5rem 0;
  border-radius: 8px;
  overflow: hidden;
  font-family: 'Monaco', 'Menlo', 'Courier New', 'Consolas', monospace;
  position: relative;
}

.code-block-wrapper pre {
  margin: 0;
  padding: 1rem;
  background-color: #1e1e1e; /* Dark background for code blocks */
  color: #d4d4d4; /* Light text color for better contrast */
  font-size: 0.875rem; /* Slightly smaller font size for code */
  line-height: 1.5;
  overflow-x: auto;
}

/* Ensure code content maintains proper styling */
.code-block-wrapper .NodeViewContent {
  font-family: 'Monaco', 'Menlo', 'Courier New', 'Consolas', monospace !important;
  white-space: pre;
  outline: none;
  caret-color: white;
}

/* Language-specific styling removed */

/* Highlight.js Theme Integration */

/* Dark Theme (VS Code Dark+) */
.hljs-dark {
  background: #1e1e1e !important;
  color: #d4d4d4 !important;
}

.theme-dark .hljs-keyword,
.theme-dark .hljs-operator,
.theme-dark .hljs-pattern-match {
  color: #569cd6;
  font-weight: bold;
}

.theme-dark .hljs-function,
.theme-dark .hljs-class .hljs-title,
.theme-dark .hljs-title.function_ {
  color: #dcdcaa;
}

.theme-dark .hljs-title.function_.invoke__,
.theme-dark .hljs-function > .hljs-title {
  color: #dcdcaa;
  font-weight: normal;
}

.theme-dark .hljs-string,
.theme-dark .hljs-doctag {
  color: #ce9178;
}

.theme-dark .hljs-number,
.theme-dark .hljs-literal {
  color: #b5cea8;
}

.theme-dark .hljs-comment,
.theme-dark .hljs-quote {
  color: #6a9955;
  font-style: italic;
}

.theme-dark .hljs-variable,
.theme-dark .hljs-template-variable,
.theme-dark .hljs-attribute {
  color: #9cdcfe;
}

.theme-dark .hljs-tag,
.theme-dark .hljs-name {
  color: #569cd6;
}

.theme-dark .hljs-attr {
  color: #92c5f7;
}

.theme-dark .hljs-built_in,
.theme-dark .hljs-builtin-name {
  color: #ccd369;
}

.theme-dark .hljs-meta {
  color: #569cd6;
}

.theme-dark .hljs-params {
  color: #9cdcfe;
}

.theme-dark .hljs-property {
  color: #9cdcfe;
}

.theme-dark .hljs-type {
  color: #4ec9b0;
}

.theme-dark .hljs-deletion {
  background: #b91c1c;
}

.theme-dark .hljs-addition {
  background: #16a34a;
}

.theme-dark .hljs-emphasis {
  font-style: italic;
}

.theme-dark .hljs-strong {
  font-weight: bold;
}

/* Light Theme (VS Code Light+) */
.hljs-light {
  background: #ffffff !important;
  color: #000000 !important;
}

.theme-light .hljs-keyword,
.theme-light .hljs-operator,
.theme-light .hljs-pattern-match {
  color: #0000ff;
  font-weight: bold;
}

.theme-light .hljs-function,
.theme-light .hljs-class .hljs-title,
.theme-light .hljs-title.function_ {
  color: #795e26;
}

.theme-light .hljs-title.function_.invoke__,
.theme-light .hljs-function > .hljs-title {
  color: #795e26;
  font-weight: normal;
}

.theme-light .hljs-string,
.theme-light .hljs-doctag {
  color: #a31515;
}

.theme-light .hljs-number,
.theme-light .hljs-literal {
  color: #098658;
}

.theme-light .hljs-comment,
.theme-light .hljs-quote {
  color: #008000;
  font-style: italic;
}

.theme-light .hljs-variable,
.theme-light .hljs-template-variable,
.theme-light .hljs-attribute {
  color: #001080;
}

.theme-light .hljs-tag,
.theme-light .hljs-name {
  color: #800000;
}

.theme-light .hljs-attr {
  color: #ff0000;
}

.theme-light .hljs-built_in,
.theme-light .hljs-builtin-name {
  color: #267f99;
}

.theme-light .hljs-meta {
  color: #0000ff;
}

.theme-light .hljs-params {
  color: #001080;
}

.theme-light .hljs-property {
  color: #001080;
}

.theme-light .hljs-type {
  color: #267f99;
}

.theme-light .hljs-deletion {
  background: #fecaca;
}

.theme-light .hljs-addition {
  background: #bbf7d0;
}

.theme-light .hljs-emphasis {
  font-style: italic;
}

.theme-light .hljs-strong {
  font-weight: bold;
}

/* Theme-specific backgrounds for code blocks */
.theme-dark pre {
  background: #1e1e1e !important;
  color: #d4d4d4 !important;
}

.theme-light pre {
  background: #ffffff !important;
  color: #000000 !important;
  border: 1px solid #e5e7eb;
}



/* Markdown-specific styling */
.theme-dark .language-markdown .hljs-section,
.theme-dark .language-markdown .hljs-title {
  color: #569cd6;
  font-weight: bold;
}

.theme-dark .language-markdown .hljs-emphasis {
  color: #ce9178;
  font-style: italic;
}

.theme-dark .language-markdown .hljs-strong {
  color: #dcdcaa;
  font-weight: bold;
}

.theme-dark .language-markdown .hljs-code {
  color: #b5cea8;
  background-color: #2d2d30;
  padding: 2px 4px;
  border-radius: 3px;
}

.theme-dark .language-markdown .hljs-link {
  color: #9cdcfe;
  text-decoration: underline;
}

.theme-light .language-markdown .hljs-section,
.theme-light .language-markdown .hljs-title {
  color: #0000ff;
  font-weight: bold;
}

.theme-light .language-markdown .hljs-emphasis {
  color: #a31515;
  font-style: italic;
}

.theme-light .language-markdown .hljs-strong {
  color: #795e26;
  font-weight: bold;
}

.theme-light .language-markdown .hljs-code {
  color: #098658;
  background-color: #f6f8fa;
  padding: 2px 4px;
  border-radius: 3px;
}

.theme-light .language-markdown .hljs-link {
  color: #001080;
  text-decoration: underline;
}

/* Mermaid diagram component styling */
.mermaid-diagram {
  max-width: 100%;
  overflow-x: auto;
  overflow-y: hidden;
}

.mermaid-content {
  max-width: 100%;
}

/* Ensure Mermaid SVG scales properly */
.mermaid-content svg {
  max-width: 100% !important;
  height: auto !important;
  display: block;
}

/* Mermaid diagram styling */
.theme-dark .language-mermaid {
  color: #d4d4d4;
  background-color: #1e1e1e;
}

.theme-dark .language-mermaid .hljs-keyword {
  color: #569cd6;
  font-weight: bold;
}

.theme-dark .language-mermaid .hljs-string {
  color: #ce9178;
}

.theme-dark .language-mermaid .hljs-title {
  color: #dcdcaa;
  font-weight: bold;
}

.theme-dark .language-mermaid .hljs-type {
  color: #4ec9b0;
}

.theme-dark .language-mermaid .hljs-variable {
  color: #9cdcfe;
}

.theme-dark .language-mermaid .hljs-number {
  color: #b5cea8;
}

.theme-dark .language-mermaid .hljs-comment {
  color: #6a9955;
  font-style: italic;
}

.theme-light .language-mermaid {
  color: #333333;
  background-color: #f8f8f8;
}

.theme-light .language-mermaid .hljs-keyword {
  color: #0000ff;
  font-weight: bold;
}

.theme-light .language-mermaid .hljs-string {
  color: #a31515;
}

.theme-light .language-mermaid .hljs-title {
  color: #795e26;
  font-weight: bold;
}

.theme-light .language-mermaid .hljs-type {
  color: #267f99;
}

.theme-light .language-mermaid .hljs-variable {
  color: #001080;
}

.theme-light .language-mermaid .hljs-number {
  color: #098658;
}

.theme-light .language-mermaid .hljs-comment {
  color: #008000;
  font-style: italic;
}

/* Mermaid preview container styling */
.mermaid-preview {
  padding: 16px;
  border-radius: 6px;
  background-color: white;
  margin: 8px 0;
  overflow: auto;
  max-width: 100%;
}

.theme-dark .mermaid-preview {
  background-color: #2d2d30;
}

.mermaid-preview svg {
  max-width: 100%;
  height: auto;
}

.mermaid-error {
  color: #f14668;
  background-color: #fdf2f2;
  border: 1px solid #f14668;
  border-radius: 4px;
  padding: 8px 12px;
  font-family: monospace;
  font-size: 14px;
  margin: 8px 0;
}

.theme-dark .mermaid-error {
  color: #ff6b7a;
  background-color: #2d1b1b;
  border-color: #ff6b7a;
}

/* Custom scrollbar for dropdown */
.scrollbar-thin {
  scrollbar-width: thin;
}

.scrollbar-thumb-gray-400 {
  scrollbar-color: #9ca3af #f3f4f6;
}

.dark .scrollbar-thumb-gray-600 {
  scrollbar-color: #4b5563 #1f2937;
}

/* Webkit scrollbar styling */
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: #f3f4f6;
  border-radius: 3px;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background: #9ca3af;
  border-radius: 3px;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background: #6b7280;
}

.dark .scrollbar-thin::-webkit-scrollbar-track {
  background: #1f2937;
}

.dark .scrollbar-thin::-webkit-scrollbar-thumb {
  background: #4b5563;
}

.dark .scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background: #6b7280;
}

/* Table Cell Selection Support */
.tiptap table {
  border-collapse: collapse;
  margin: 1rem 0;
  overflow: hidden;
  table-layout: fixed;
  width: 100%;
}

.tiptap table td,
.tiptap table th {
  border: 2px solid #ced4da;
  box-sizing: border-box;
  min-width: 1em;
  padding: 0.5rem;
  position: relative;
  vertical-align: top;
}

.tiptap table th {
  background-color: #f8f9fa;
  font-weight: bold;
  text-align: left;
}

/* Table cell selection (highlight entire cell) */
.tiptap table .selectedCell,
.tiptap table td.selectedCell,
.tiptap table th.selectedCell {
  background-color: rgba(59, 130, 246, 0.15);
  border-color: #3b82f6;
}

/* Table content selection within cells (highlight text content only) */
.tiptap table td::selection,
.tiptap table th::selection,
.tiptap table td *::selection,
.tiptap table th *::selection {
  background-color: rgba(59, 130, 246, 0.3);
}

/* Active cell border for editing */
.tiptap table td:focus,
.tiptap table th:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 1px #3b82f6;
}

/* Table resize handle */
.tiptap table .resize-cursor {
  cursor: col-resize;
}

/* ProseMirror table selection classes */
.tiptap .ProseMirror-selectednode {
  outline: 2px solid #3b82f6;
}

.tiptap table .ProseMirror-cell-selection {
  background-color: rgba(59, 130, 246, 0.15);
}

/* Table hover effects - DISABLED to prevent interference with custom background colors */
/* 
.tiptap table td:hover,
.tiptap table th:hover {
  background-color: rgba(0, 0, 0, 0.02);
}

.tiptap table th:hover {
  background-color: rgba(0, 0, 0, 0.05);
}
*/

/* Remove all hover effects from table cells to prevent interference with custom background colors */
.tiptap table td,
.tiptap table th {
  /* Remove hover effects completely */
  background-color: transparent;
}

/* Ensure custom background colors via style attribute take priority */
.tiptap table td[style*="background-color"],
.tiptap table th[style*="background-color"] {
  /* Preserve custom background colors and prevent hover override */
  position: relative;
}

/* Dark theme table styles */
.theme-dark .tiptap table td,
.theme-dark .tiptap table th {
  border-color: #4b5563;
}

.theme-dark .tiptap table th {
  background-color: #374151;
  color: #f9fafb;
}

.theme-dark .tiptap table .selectedCell,
.theme-dark .tiptap table td.selectedCell,
.theme-dark .tiptap table th.selectedCell {
  background-color: rgba(59, 130, 246, 0.25);
}

/* Dark theme hover effects - DISABLED to prevent interference with custom background colors */
/*
.theme-dark .tiptap table td:hover,
.theme-dark .tiptap table th:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.theme-dark .tiptap table th:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
*/

/* Link styles with hover effects */
.tiptap a.tiptap-link {
  color: #3b82f6;
  text-decoration: underline;
  text-decoration-thickness: 1px;
  text-underline-offset: 2px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: inline;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.tiptap a.tiptap-link:hover {
  color: #1d4ed8;
  text-decoration-thickness: 2px;
}

/* Link preview animation classes */
.animate-in {
  animation-name: animate-in;
  animation-duration: 200ms;
  animation-timing-function: ease;
  animation-fill-mode: both;
}

.fade-in-0 {
  animation-name: fade-in;
}

.zoom-in-95 {
  animation-name: zoom-in;
  --tw-scale: 0.95;
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoom-in {
  from { 
    opacity: 0;
    transform: scale(var(--tw-scale, 0.95));
  }
  to { 
    opacity: 1;
    transform: scale(1);
  }
}

/* Line clamp utilities for preview text */
.line-clamp-2 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  line-clamp: 2;
}

/* Dark theme link styles */
.theme-dark .tiptap a.tiptap-link {
  color: #60a5fa;
  display: inline;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.theme-dark .tiptap a.tiptap-link:hover {
  color: #93c5fd;
}

/* Search highlight styles - using decorations instead of marks */
.pm-search-hit {
  background-color: rgba(255, 215, 0, 0.4) !important;
  border-radius: 2px;
  padding: 0 2px;
}

.pm-search-current {
  background-color: rgba(255, 165, 0, 0.6) !important;
  border-radius: 2px;
  padding: 0 2px;
  box-shadow: 0 0 0 2px rgba(255, 165, 0, 0.3);
}

.pm-search-hover {
  animation: pulse-highlight 1s ease-out;
}

@keyframes pulse-highlight {
  0%, 100% {
    box-shadow: 0 0 0 2px rgba(255, 165, 0, 0.3);
  }
  50% {
    box-shadow: 0 0 0 4px rgba(255, 165, 0, 0.5), 0 0 8px rgba(255, 165, 0, 0.3);
  }
}

/* Custom scrollbar for components */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e0 #f7fafc;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: #f7fafc;
  border-radius: 4px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #cbd5e0;
  border-radius: 4px;
  border: 2px solid #f7fafc;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: #a0aec0;
}

/* Zoom transform wrapper */
.document-content-wrapper {
  transition: transform 0.2s ease;
}

/* Navigation pane hover effects */
.navigation-pane-item {
  transition: all 0.15s ease;
}

.navigation-pane-item:hover {
  background-color: rgba(59, 130, 246, 0.1);
}

/* Word count floating panel */
.word-count-panel {
  backdrop-filter: blur(10px);
  background: rgba(255, 255, 255, 0.95);
}

/* Keyboard key styling */
kbd {
  display: inline-block;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  line-height: 1;
  background-color: #f7fafc;
  border: 1px solid #cbd5e0;
  border-radius: 0.25rem;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05), inset 0 -1px 0 rgba(0, 0, 0, 0.1);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-weight: 600;
  color: #2d3748;
}

/* ChatSidebar inline code styling - matches TipTap editor */
.chat-markdown-content code {
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important;
  font-size: 0.9em !important;
  background-color: #f3f4f6 !important;
  color: #1f2937 !important;
  padding: 0.2em 0.4em !important;
  border-radius: 4px !important;
  border: 1px solid #e5e7eb !important;
  box-shadow: 0 1px 0 rgba(0, 0, 0, 0.05) !important;
  white-space: pre-wrap !important;
  word-break: break-word !important;
}

/* ChatSidebar code inside pre blocks should not have these styles */
.chat-markdown-content pre code {
  background-color: transparent !important;
  color: inherit !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
}

/* ChatSidebar code blocks with topics - Dark styling matching code content */
.code-block-with-topic {
  margin: 0.5rem 0;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid #2d2d2d;
}

.code-topic-header {
  background-color: #1e1e1e; /* Dark background matching code block */
  color: #9cdcfe; /* Light blue text for better contrast */
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 0.85rem;
  font-weight: 600;
  padding: 0.5rem 1rem;
  border-bottom: 1px solid #2d2d2d;
  text-transform: lowercase;
  letter-spacing: 0.5px;
}

.code-block-pre {
  background-color: #1e1e1e !important;
  color: #d4d4d4 !important;
  padding: 1rem !important;
  margin: 0 !important;
  overflow-x: auto;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  font-size: 0.875rem;
  line-height: 1.5;
}

.code-block-pre code {
  background: transparent !important;
  color: inherit !important;
  padding: 0 !important;
  border: none !important;
  box-shadow: none !important;
  font-family: inherit;
}

/* ============================================================================
   VERSION HISTORY READ-ONLY VIEWER STYLES
   ============================================================================ */

/* Read-only TipTap editor for version history */
.tiptap-readonly {
  background-color: #f9fafb;
  padding: 2rem;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
}

.tiptap-readonly .ProseMirror {
  outline: none;
  cursor: default;
}

/* Ensure all content in read-only mode is selectable but not editable */
.tiptap-readonly * {
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  -ms-user-select: text !important;
  cursor: text !important;
}
/* Image styling with resize support and border */
.tiptap img.tiptap-image {
  max-width: 100%;
  height: auto;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  cursor: pointer;
  display: block;
  margin: 1rem auto;
  transition: all 0.2s ease;
}

.tiptap img.tiptap-image:hover {
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.tiptap img.tiptap-image.ProseMirror-selectednode {
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
  outline: none;
  position: relative;
}

/* Image resize handles */
.tiptap img.tiptap-image.ProseMirror-selectednode::after {
  content: '';
  position: absolute;
  right: -4px;
  bottom: -4px;
  width: 12px;
  height: 12px;
  background: #3b82f6;
  border: 2px solid white;
  border-radius: 50%;
  cursor: nwse-resize;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Dark theme image styles */
.theme-dark .tiptap img.tiptap-image {
  border-color: #4b5563;
}

.theme-dark .tiptap img.tiptap-image:hover {
  border-color: #60a5fa;
  box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.15);
}

.theme-dark .tiptap img.tiptap-image.ProseMirror-selectednode {
  border-color: #60a5fa;
  box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.25);
}

/* ===========================
   AI Chat Tool Execution Styles
   =========================== */

/* Stage block container */
.stage-block {
  margin: 0.75rem 0;
  padding: 0.5rem 0;
  border-bottom: 1px solid #e5e7eb;
}

.stage-block:last-child {
  border-bottom: none;
}

/* Stage content - the actual message */
.stage-content {
  margin-bottom: 0.5rem;
  color: #374151;
  font-size: 0.9375rem;
  line-height: 1.6;
}

/* Stage indicator at the END of content */
.stage-indicator {
  display: flex;
  justify-content: flex-end;
  margin-top: 0.5rem;
  padding-top: 0.5rem;
}

.stage-label {
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.75rem;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: capitalize;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #ffffff;
  border-radius: 12px;
  letter-spacing: 0.025em;
  box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
}

/* Tool execution block container */
.tool-execution-block {
  margin: 0.75rem 0;
  padding: 0.875rem 1rem;
  background-color: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.tool-execution-block:hover {
  background-color: #f3f4f6;
  border-color: #d1d5db;
}

/* Tool header - flex container with tool tag on left, status on right */
.tool-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.5rem;
  gap: 0.75rem;
}

/* Tool tag - badge style */
.tool-tag {
  display: inline-flex;
  align-items: center;
  padding: 0.25rem 0.75rem;
  font-size: 0.8125rem;
  font-weight: 600;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #ffffff;
  border-radius: 6px;
  letter-spacing: 0.025em;
  box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
  white-space: nowrap;
}

/* Tool status indicator - positioned on right side */
.tool-status {
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  padding: 0.25rem 0.625rem;
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 6px;
  white-space: nowrap;
  transition: all 0.2s ease;
}

/* Loading state */
.tool-status.loading {
  background-color: #fef3c7;
  color: #92400e;
  border: 1px solid #fbbf24;
}

.tool-status.loading::before {
  content: '⏳';
  margin-right: 0.25rem;
}

/* Success state */
.tool-status.success {
  background-color: #d1fae5;
  color: #065f46;
  border: 1px solid #34d399;
}

.tool-status.success::before {
  content: '✓';
  margin-right: 0.25rem;
  font-weight: 700;
}

/* Failed state */
.tool-status.failed {
  background-color: #fee2e2;
  color: #991b1b;
  border: 1px solid #f87171;
}

.tool-status.failed::before {
  content: '✕';
  margin-right: 0.25rem;
  font-weight: 700;
}

/* Tool description */
.tool-description {
  color: #374151;
  font-size: 0.9375rem;
  line-height: 1.6;
  padding-left: 0.25rem;
}

/* Tool result container */
.tool-result {
  margin-top: 0.625rem;
  padding: 0.75rem;
  background-color: #ffffff;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  font-size: 0.875rem;
  line-height: 1.5;
  color: #1f2937;
  white-space: pre-wrap;
  word-break: break-word;
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
}

/* Dark theme styles for tool execution */
.theme-dark .stage-block {
  border-bottom-color: #374151;
}

.theme-dark .tool-execution-block {
  background-color: #1f2937;
  border-color: #374151;
}

.theme-dark .tool-execution-block:hover {
  background-color: #111827;
  border-color: #4b5563;
}

.theme-dark .tool-status.loading {
  background-color: #78350f;
  color: #fbbf24;
  border-color: #92400e;
}

.theme-dark .tool-status.success {
  background-color: #064e3b;
  color: #34d399;
  border-color: #065f46;
}

.theme-dark .tool-status.failed {
  background-color: #7f1d1d;
  color: #f87171;
  border-color: #991b1b;
}

.theme-dark .tool-description {
  color: #d1d5db;
}

.theme-dark .tool-result {
  background-color: #111827;
  border-color: #374151;
  color: #e5e7eb;
}

/* ============================================================================
   MERMAID DIAGRAM ZOOM CONTROLS STYLES
   ============================================================================ */

/* Zoom button hover effects */
.zoom-button:hover:not(:disabled) {
  background-color: #f3f4f6 !important;
  border-color: #9ca3af !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.zoom-button:active:not(:disabled) {
  transform: scale(0.95);
}

/* Mermaid diagram focus outline */
.mermaid-diagram:focus {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

.mermaid-diagram:focus:not(:focus-visible) {
  outline: none;
}

/* ============================================================================
   PRINT STYLES FOR MERMAID DIAGRAMS
   ============================================================================ */

@media print {
  /* Hide zoom controls when printing */
  .no-print,
  .mermaid-zoom-controls {
    display: none !important;
  }

  /* Page break rules for headings */
  .tiptap h1,
  .ProseMirror h1 {
    page-break-before: always !important;
    break-before: page !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
    margin-top: 0 !important;
  }

  /* First h1 should not force a page break */
  .tiptap h1:first-child,
  .ProseMirror h1:first-child {
    page-break-before: auto !important;
    break-before: auto !important;
  }

  .tiptap h2,
  .ProseMirror h2 {
    page-break-before: always !important;
    break-before: page !important;
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  /* Prevent orphaned headings */
  .tiptap h1,
  .tiptap h2,
  .tiptap h3,
  .tiptap h4,
  .tiptap h5,
  .tiptap h6 {
    page-break-after: avoid !important;
    break-after: avoid !important;
  }

  /* Keep heading with at least 2 lines of following content */
  .tiptap h1 + p,
  .tiptap h2 + p,
  .tiptap h3 + p {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }


  /* Reset Mermaid diagram container for print */
  .mermaid-diagram {
    border: 1px solid #e0e0e0 !important;
    border-radius: 0 !important;
    padding: 20px !important;
    background-color: white !important;
    margin: 10px 0 !important;
    max-width: 100% !important;
    overflow: visible !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Reset zoom transform and pan for print */
  .mermaid-content-wrapper,
  .mermaid-content {
    transform: none !important;
    display: block !important;
    width: 100% !important;
    max-width: 100% !important;
    cursor: default !important;
  }

  /* Ensure Mermaid SVG fits properly on print */
  .mermaid-content svg {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 0 auto !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Prevent page breaks inside diagrams */
  .mermaid-diagram,
  .mermaid-content,
  .mermaid-preview {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Ensure diagram text is readable */
  .mermaid-content svg text {
    fill: #000000 !important;
  }

  /* Ensure diagram shapes have visible borders */
  .mermaid-content svg rect,
  .mermaid-content svg circle,
  .mermaid-content svg ellipse,
  .mermaid-content svg polygon,
  .mermaid-content svg path {
    stroke: #000000 !important;
  }
}

/*
    ============================================================================
    NAVIGATION HEADINGRESPONSIVE STYLES
    ============================================================================ 
*/

.ProseMirror h1,
.ProseMirror h2,
.ProseMirror h3,
.ProseMirror h4,
.ProseMirror h5,
.ProseMirror h6 {
  scroll-margin-top: 50px; /* Adjusted for toolbar + padding with scroll-into-view-if-needed */
}

@media (max-width: 768px) {
  .ProseMirror h1,
  .ProseMirror h2,
  .ProseMirror h3 {
    scroll-margin-top: 40px; /* Reduced margin for mobile */
  }
}
